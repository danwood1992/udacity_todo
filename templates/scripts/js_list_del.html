<script>
     async function getlists() {
        var response = await fetch('/getlists/')

        console.log(response)
        .then(response => response.json())
        .then(data => { 
            var lists = data.lists;
        } )
       
        return lists; 
    }

    async function deleteList(listid) {
        try {
            const response = await fetch('/lists/delete', {
                method: 'POST',
                body: JSON.stringify({ 'listid': listid }),
                headers: { 'Content-Type': 'application/json' }
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            return await response.json();
            const jsonResponse = await response.json();
            return jsonResponse;

        } catch (error) {
            console.error('Failed to Delete list:', error);            
        }
    }

    
    function removelistElem(listname) {
        console.log("Removing sidebar lists");
        console.log(listname);
        const sidebarListDiv = document.getElementById("sidebar-" + listname);
        const mainListDiv = document.getElementById(listname)
        sidebarListDiv.remove();
        mainListDiv.remove(); 
    }

{% for list in lists %}
   
    document.getElementById("delete-list-form-{{list.id}}").onsubmit = async function(e) {
        e.preventDefault();
        console.log("delete js script triggered");
        console.log(e);
        const listid = e.target.listid.value;
        const listname = e.target.listname.value;
        const success = await deleteList(listid);
        if (success) {
            console.log("deleted" + listname);
            removelistElem(listname)
        }
        
    };
{% endfor %}
 
</script>



